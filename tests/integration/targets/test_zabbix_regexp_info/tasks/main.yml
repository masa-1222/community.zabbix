---
- name: test - try to update regexp (present)
  community.zabbix.zabbix_regexp:
    name: File systems for discovery
    test_string: ext3
    expressions:
      - expression: "^(btrfs|ext2|ext3|ext4|reiser|xfs|ffs|ufs|jfs|jfs2|vxfs|hfs|apfs|refs|ntfs|fat32|zfs)$"
        expression_type: result_is_true
  register: zbxregexp_update

- name: assert that regexp was NOT updated
  ansible.builtin.assert:
    that:
      - zbxregexp_update.changed is sameas False

- name: test - try to retrieve regexp
  community.zabbix.zabbix_regexp_info:
    name: File systems for discovery
  register: zbxregexp_get

- name: test - try to update regexp with retrieved values
  community.zabbix.zabbix_regexp:
    name: "{{ zbxregexp_get.regexp.name }}"
    test_string: "{{ zbxregexp_get.regexp.test_string }}"
    expressions: "{{ zbxregexp_get.regexp.expressions }}"
  register: zbxregexp_update

- name: assert that regexp was NOT updated
  ansible.builtin.assert:
    that:
      - zbxregexp_update.changed is sameas False
